@model IEnumerable<Gallery>
@using BryceFamily.Web.MVC.Infrastructure.Authentication
@inject BryceFamily.Web.MVC.Infrastructure.ContextService ContextService
@inject BryceFamily.Web.MVC.Infrastructure.ClanAndPeopleService ClanService

    @{
        ViewData["Title"] = "Index";
        Layout = "~/Views/Shared/_Layout.cshtml";
    }


    <div class="col-md-10">
        <div class="row">
            <div class="col-md-8">
                <h3>Family Galleries</h3>
                <ul class="event-summary">
                   @foreach (var clan in ClanService.Clans.OrderBy(t => t.DisplayOrder))
                   {
                       <li>
                        <h3>@clan.FormattedName</h3>
                           <ul>
                            @foreach (var evt in Model.Where(g => g.Clan.Id == clan.Id).OrderBy(c => c.GalleryDate))
                            {
                                <li class="event">
                                <h4>@Html.ActionLink(string.IsNullOrEmpty(evt.Title) ? "Link" : evt.Title, "Detail", "Gallery", new { id = evt.Id }, new { @class = "detail-link" })</h4>
                                <div>
                                    @Html.DisplayFor(t => evt.Summary)
                                </div>

                                @if (User.IsInRole(RoleNameConstants.AdminRole) || User.IsInRole(RoleNameConstants.SuperAdminRole))
                                {
                                    <div>@Html.ActionLink("Edit Images", "EditGalleryImages", "Gallery", new { id = evt.Id }, new { @class = "btn btn-sml" })</div>
                                }
                                </li>
                            }
                            </ul>
                        </li>
                    }
                </ul>
            </div>
    
        </div>
        @if (User.IsInRole(RoleNameConstants.AdminRole) || User.IsInRole(RoleNameConstants.SuperAdminRole))
        {
            <div class="row">
                <div class="col-md-4">
                    <span class="editorButton">@Html.ActionLink("Add New", "NewGallery", "Gallery", null, new { @class = "btn btn-primary" })</span>
                </div>
            </div>
        }
    </div>

